CREATE DATABASE IF NOT EXISTS PedidoProntoDB;
USE PedidoProntoDB;


CREATE TABLE IF NOT EXISTS Clientes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    telefone VARCHAR(20),
    endereco VARCHAR(200),
    data_cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
select * from clientes;

	CREATE TABLE IF NOT EXISTS Produtos (
		id INT AUTO_INCREMENT PRIMARY KEY,
		nome VARCHAR(100) NOT NULL,
		descricao TEXT,
		preco DECIMAL(10,2) NOT NULL,
		ativo BOOLEAN DEFAULT TRUE
	);




CREATE TABLE IF NOT EXISTS Pedidos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT NOT NULL,
    data_pedido TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status ENUM('pendente', 'preparo', 'pronto', 'entregue', 'cancelado') DEFAULT 'pendente',
    observacoes TEXT,
    
    CONSTRAINT fk_pedido_cliente
    FOREIGN KEY (cliente_id) REFERENCES Clientes(id)
    ON DELETE RESTRICT
    ON UPDATE CASCADE
);


CREATE TABLE IF NOT EXISTS ItensPedido (
    id INT AUTO_INCREMENT PRIMARY KEY,
    pedido_id INT NOT NULL,
    produto_id INT NOT NULL,
    quantidade INT NOT NULL DEFAULT 1,
    preco_unitario DECIMAL(10,2) NOT NULL,
    
    CONSTRAINT fk_item_pedido
    FOREIGN KEY (pedido_id) REFERENCES Pedidos(id)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
    
    CONSTRAINT fk_item_produto
    FOREIGN KEY (produto_id) REFERENCES Produtos(id)
    ON DELETE RESTRICT
    ON UPDATE CASCADE
);

-- Tabela Caixa
CREATE TABLE IF NOT EXISTS Caixa (
    id INT AUTO_INCREMENT PRIMARY KEY,
    status ENUM('aberto', 'fechado') DEFAULT 'aberto',
    saldo_inicial DECIMAL(10,2) DEFAULT 0,
    saldo_atual DECIMAL(10,2) DEFAULT 0,
    data_abertura DATETIME,
    data_fechamento DATETIME,
    responsavel VARCHAR(100)
);



