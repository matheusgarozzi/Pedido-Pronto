-- Criação do banco de dados
CREATE DATABASE IF NOT EXISTS PedidoProntoDB;
USE PedidoProntoDB;

-- Tabela: usuarios
CREATE TABLE usuarios (
    id INT(11) NOT NULL AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    senha VARCHAR(255) NOT NULL,
    email VARCHAR(100) DEFAULT NULL,
    nivel_acesso ENUM('admin', 'gerente', 'atendente') DEFAULT 'atendente',
    data_criacao TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    ultimo_login DATETIME DEFAULT NULL,
    ativo TINYINT(1) DEFAULT 1,
    PRIMARY KEY (id),
    UNIQUE KEY username (username)
);

-- Tabela: produtos
CREATE TABLE produtos (
    id INT(11) NOT NULL AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    descricao TEXT DEFAULT NULL,
    preco DECIMAL(10,2) NOT NULL,
    ativo TINYINT(1) DEFAULT 1,
    imagem VARCHAR(255) DEFAULT NULL,
    PRIMARY KEY (id)
);

-- Tabela: clientes
CREATE TABLE clientes (
    id INT(11) NOT NULL AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    telefone VARCHAR(20) DEFAULT NULL,
    endereco VARCHAR(200) DEFAULT NULL,
    data_cadastro TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
);

-- Tabela: pedidos
CREATE TABLE pedidos (
    id INT(11) NOT NULL AUTO_INCREMENT,
    cliente_id INT(11) NOT NULL,
    data_pedido TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    status ENUM('pendente', 'preparo', 'pronto', 'entregue') DEFAULT 'pendente',
    observacoes TEXT DEFAULT NULL,
    PRIMARY KEY (id),
    KEY cliente_id (cliente_id),
    FOREIGN KEY (cliente_id) REFERENCES clientes(id)
);

-- Tabela: pedido_itens
CREATE TABLE pedido_itens (
    id INT(11) NOT NULL AUTO_INCREMENT,
    pedido_id INT(11) NOT NULL,
    produto_id INT(11) NOT NULL,
    quantidade INT(11) NOT NULL DEFAULT 1,
    preco_unitario DECIMAL(10,2) NOT NULL,
    PRIMARY KEY (id),
    KEY pedido_id (pedido_id),
    KEY produto_id (produto_id),
    FOREIGN KEY (pedido_id) REFERENCES pedidos(id),
    FOREIGN KEY (produto_id) REFERENCES produtos(id)
);
CREATE TABLE IF NOT EXISTS Caixa (
    id INT AUTO_INCREMENT PRIMARY KEY,
    status ENUM('aberto', 'fechado') DEFAULT 'aberto',
    saldo_inicial DECIMAL(10,2) DEFAULT 0,
    saldo_atual DECIMAL(10,2) DEFAULT 0,
    data_abertura DATETIME,
    data_fechamento DATETIME,
    responsavel VARCHAR(100)
);
